+function(e){var g,h={};var f=function(i){this.options=this.getParams(i);this.createTpl();d.on()};f.DEFAULTS={displayError:1000,template:'<div id="atpl"><div class="overlay"></div><span id="aiMsg" class="imgLoader"> Loading...</span></div>',idTpl:"atpl",idMsg:"aiMsg"};f.prototype={constructor:f,createTpl:function(){!e("#"+this.options.idTpl).length?e("body").append(e(this.options.template).css("display","none")):""},error:function(k,j){var i=0;j=g.getParams(j);if(("aiMask" in j)){if(e("#"+j.aiMask+" .aimask").is(":visible")){i=j.displayError}}else{if(j.error&&e("#"+j.idTpl).is(":visible")){i=j.displayError}}if(i){e("#"+j.idMsg).removeClass("imgLoader");var l=d.getMsg(j);d.setMsg("<b>Error</b>: "+k,j);setTimeout(function(){g.hide(j);d.setMsg(l,j);e("#"+j.idMsg).addClass("imgLoader")},j.displayError)}else{g.hide(j)}},getLoader:function(j){j=g.getParams(j);var i="#"+j.idTpl;return(e(i).length)?e(i):e(i,window.parent.document)},getParams:function(i){i=e.extend({},this.getDefaults(),i);e.each(i,function(k,j){if(e.isFunction(i[k])){i[k]=i[k]()}});return i},getDefaults:function(){return e.extend({},f.DEFAULTS,this.options)},getXHRParams:function(i){return(i==undefined||!("aiParams" in i))?this.getParams():i.aiParams},hide:function(i){i=g.getParams(i);var j=g.getIdRequest(i);if(h[j]==undefined){return}h[j].shift();if(!h[j].length){!("aiMask" in i)?d.hide(i):d.unmask(i)}},getIdRequest:function(i){return("aiMask" in i)?i.aiMask:i.idTpl},isDisable:function(i){if(i==undefined){return false}if(("data" in i)&&(typeof i.data=="string")&&i.data.search("aiDisable")!=-1){return true}if(("url" in i)&&(typeof i.url=="string")&&i.url.search("aiDisable")!=-1){return true}}};var d=e.ai=function(i){if(i){g=new f(i)}return this};d.mask=function(k){if(e("#"+k.aiMask+" .aimask").length){return}var n=e("#"+k.aiMask);if(n.css("position")=="static"){n.addClass("aimasked-relative")}n.addClass("aimasked").append('<div class="aimask"></div>');var m=d.getMsg(k);if(("aiMaskmsg" in k)){m=k.aiMaskmsg}var j=e('<div class="aimask-msg">'+m+"</div>");n.append(j);var i=j.outerWidth(true);var l=j.outerHeight(true);j.css("top",Math.round(n.height()/2-l/2)+"px").css("left",Math.round(n.width()/2-i/2)+"px").fadeIn("fast")};d.unmask=function(i){e("#"+i.aiMask).removeClass("aimasked-relative aimasked aimask").find(".aimask, .aimask-msg").remove()};d.getMsg=function(i){i=g.getParams(i);return e(g.getLoader(i)).find("#"+i.idMsg).html()};d.setMsg=function(j,i){i=g.getParams(i);!("aiMask" in i)?e(g.getLoader(i)).find("#"+i.idMsg).html(j):e("#"+i.aiMask+" .aimask-msg").html(j)};d.hide=function(i){e(g.getLoader(g.getParams(i))).hide()};d.show=function(i){i=g.getParams(i);("aiMask" in i)?d.mask(i):e(g.getLoader(i)).show(10)};d.off=function(){e(document).off(".ai")};d.on=function(){d.off();e(document).on("ajaxSend.ai",function(j,i,k){if(a){i=e.extend(i,{aiParams:g.getParams(a)});a=false}else{i=e.extend(i,{aiParams:g.options})}if(!g.isDisable(k)&&!("aiDisable" in i.aiParams)){var l=g.getIdRequest(i.aiParams);if(h[l]==undefined){h[l]=[]}h[l].push(i);d.show(i.aiParams)}}).on("ajaxError.ai",function(j,i,k){i.aiParams.error=true;g.error(i.statusText,g.getXHRParams(i))}).on("ajaxComplete.ai",function(j,i,k){!i.aiParams.error?g.hide(g.getXHRParams(i)):i.aiParams.error=false})};var c=e.ai;e.ai.Constructor=f;var b=function(i){i.preventDefault();a=g.getParams(e.extend({},e(i.target).data(),{error:false},{target:i.target}))};e.ai.noConflict=function(){e.ai=c;return this};e.fn.ai=function(i){return this.each(function(){var j=e(this),k=j.data();j.data(e.extend({},i,k)).on("click.ai-api",function(l){b(l)})})};var a;e(function(){e("[data-id-tpl], [data-id-msg], [data-ai-mask], [data-ai-maskmsg], [data-ai-disable]",document).on("click.ai-api, keyup.ai-api, ",function(i){b(i)});g=new f()})}(window.jQuery);